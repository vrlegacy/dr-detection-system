<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Diabetic Retinopathy Detection</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: #f5f8fc;
        padding-top: 40px;
      }
      h2 {
        color: #222;
      }
      input,
      button {
        padding: 10px;
        margin: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 15px;
      }
      button {
        background: #007bff;
        color: white;
        cursor: pointer;
      }
      button:hover {
        background: #0056b3;
      }
      .preview {
        margin-top: 15px;
      }
      img {
        width: 200px;
        border-radius: 10px;
        margin-top: 10px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      }
      .result {
        margin-top: 25px;
        font-size: 18px;
        font-weight: 600;
      }
      .score-bar {
        width: 300px;
        height: 20px;
        background: #ddd;
        margin: 15px auto;
        border-radius: 10px;
        overflow: hidden;
      }
      .bar {
        height: 20px;
        width: 0%;
        background: #4caf50;
        transition: width 0.8s ease, background 0.8s ease;
      }
    </style>
  </head>
  <body>
    <h2>ðŸ©º Diabetic Retinopathy Detection</h2>
    <form id="uploadForm">
      <input
        type="file"
        id="imageInput"
        name="file"
        accept="image/*"
        required
      />
      <button type="submit">Predict</button>
    </form>

    <div class="preview">
      <img id="previewImg" src="#" alt="Preview" style="display: none" />
    </div>

    <div class="result" id="result"></div>
    <div class="score-bar"><div class="bar" id="bar"></div></div>

    <script>
      const form = document.getElementById("uploadForm");
      const resultDiv = document.getElementById("result");
      const bar = document.getElementById("bar");
      const previewImg = document.getElementById("previewImg");

      document.getElementById("imageInput").addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (file) {
          previewImg.src = URL.createObjectURL(file);
          previewImg.style.display = "block";
        }
      });

      // Simulated prediction labels
      const labels = [
        "No Diabetic Retinopathy",
        "Mild",
        "Moderate",
        "Severe",
        "Proliferative DR",
      ];

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        resultDiv.textContent = "Processing... ðŸ•’";
        bar.style.width = "0%";
        bar.style.background = "#4caf50";

        // Simulate prediction delay
        await new Promise((r) => setTimeout(r, 1000));

        // Generate random prediction (1â€“5)
        const randomIndex = Math.floor(Math.random() * 5);
        const severityScore = randomIndex + 1;
        const confidence = (Math.random() * 50 + 50).toFixed(2); // random 50â€“100%

        const predictedLabel = labels[randomIndex];

        // Show results
        resultDiv.textContent = `Prediction: ${predictedLabel} 
        (Score: ${severityScore}/5, Confidence: ${confidence}%)`;

        // Progress bar color
        const width = (severityScore / 5) * 100;
        bar.style.width = `${width}%`;

        if (severityScore <= 2) {
          bar.style.background = "#4caf50"; // green
        } else if (severityScore === 3) {
          bar.style.background = "#ffcc00"; // yellow
        } else {
          bar.style.background = "#f44336"; // red
        }
      });
    </script>
  </body>
</html>
